{% extends "base.html" %}

{% block title %}Ficha Médica{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>Ficha Médica: {{ paciente.username }}</h2>
        <a href="{{ url_for('perfil_paciente', paciente_id=paciente.id) }}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-2"></i>Voltar ao Perfil
        </a>
    </div>

    <div class="card p-4 shadow-sm">
        <form action="{{ url_for('salvar_ficha_medica') }}" method="POST">
            <input type="hidden" name="paciente_id" value="{{ paciente.id }}">
            <input type="hidden" name="paciente_username" value="{{ paciente.username }}">

            <div class="mb-3">
                <label for="condicao_atual" class="form-label fw-bold">Condição Atual:</label>
                <textarea id="condicao_atual" name="condicao_atual" class="form-control" rows="3"
                    placeholder="Descreva a condição de saúde atual do paciente...">{{ ficha.condicao_atual if ficha and ficha.condicao_atual is not none else '' }}</textarea>
            </div>

            <div class="mb-3">
                <label for="alergias" class="form-label fw-bold">Alergias Conhecidas:</label>
                <textarea id="alergias" name="alergias" class="form-control" rows="3"
                    placeholder="Liste as alergias do paciente...">{{ ficha.alergias if ficha and ficha.alergias is not none else '' }}</textarea>
            </div>

            <div class="mb-3">
                <label for="historico_familiar" class="form-label fw-bold">Histórico Familiar:</label>
                <textarea id="historico_familiar" name="historico_familiar" class="form-control" rows="3"
                    placeholder="Detalhe o histórico de doenças familiares relevantes...">{{ ficha.historico_familiar if ficha and ficha.historico_familiar is not none else '' }}</textarea>
            </div>

            <div class="mb-3">
                <label for="medicamentos_uso" class="form-label fw-bold">Medicamentos em Uso:</label>
                <textarea id="medicamentos_uso" name="medicamentos_uso" class="form-control" rows="3"
                    placeholder="Liste os medicamentos que o paciente está a tomar...">{{ ficha.medicamentos_uso if ficha and ficha.medicamentos_uso is not none else '' }}</textarea>
            </div>

            <div class="d-flex justify-content-end gap-2 mt-4">
                <a href="{{ url_for('perfil_paciente', paciente_id=paciente.id) }}" class="btn btn-outline-secondary">Cancelar</a>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save me-2"></i>Salvar Ficha
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}