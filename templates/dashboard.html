{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="p-5 mb-4 bg-light rounded-3 shadow-sm text-center">
        <h1 class="display-4">Bem-vindo, {{ session['username'] }}! üëã</h1>
        <p class="lead">Simplifique seu controle de glicemia e gerencie seu diabetes de forma eficiente.</p>
        <hr class="my-4">
        <p>Acesse as ferramentas e calculadoras abaixo para um acompanhamento mais completo.</p>
    </div>
    <div class="card p-3 shadow-sm">
        <h5 class="card-title">Total de Calorias (Hoje)</h5>
        <p class="card-text fs-2 fw-bold text-success">{{ total_calorias_diarias }} kcal</p>
    </div>
    {% if resumo_dados['ultimo_registro'] %}
    <h2 class="text-center mt-5 mb-4 text-secondary">Seu Resumo R√°pido</h2>
    <div class="row row-cols-1 row-cols-md-3 g-4 mb-5">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-secondary text-white text-center">
                <div class="card-body">
                    <i class="fas fa-arrow-circle-right fa-2x mb-2"></i>
                    <h5 class="card-title">√öltimo Registro</h5>
                    <h2 class="card-text display-6">{{ resumo_dados['ultimo_registro']['valor'] }} mg/dL</h2>
                    <p class="card-text"><small>{{ resumo_dados['tempo_desde_ultimo'] }}</small></p>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-info text-dark text-center">
                <div class="card-body">
                    <i class="fas fa-chart-bar fa-2x mb-2"></i>
                    <h5 class="card-title">M√©dia (√öltimos 7 Dias)</h5>
                    <h2 class="card-text display-6">
                        {% if resumo_dados['media_ultima_semana'] %}
                        {{ resumo_dados['media_ultima_semana'] }} mg/dL
                        {% else %}
                        N/A
                        {% endif %}
                    </h2>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 text-white text-center" style="background-color: #6c757d;">
                <div class="card-body">
                    <i class="fas fa-exclamation-triangle fa-2x mb-2"></i>
                    <h5 class="card-title">Eventos Extremos</h5>
                    <p class="card-text">
                        <span class="text-warning">Hiper: {{ resumo_dados['hiperglicemia_count'] }}</span>
                        <span class="mx-2">|</span>
                        <span class="text-danger">Hipo: {{ resumo_dados['hipoglicemia_count'] }}</span>
                    </p>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <h2 class="text-center mb-4 text-secondary">Ferramentas Di√°rias</h2>
    <div class="row row-cols-1 row-cols-md-2 g-4 justify-content-center">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-success text-white">
                <div class="card-body d-flex flex-column align-items-center text-center">
                    <i class="fas fa-notes-medical fa-3x mb-3"></i>
                    <h5 class="card-title">Registrar Glicemia e Refei√ß√£o</h5>
                    <p class="card-text">Adicione seus novos registros e acompanhe seu progresso di√°rio.</p>
                    <a href="{{ url_for('registrar_glicemia') }}" class="btn btn-outline-light mt-auto">
                        <i class="fas fa-plus-circle me-2"></i>Registrar
                    </a>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-primary text-white">
                <div class="card-body d-flex flex-column align-items-center text-center">
                    <i class="fas fa-chart-line fa-3x mb-3"></i>
                    <h5 class="card-title">Ver Registros</h5>
                    <p class="card-text">Visualize, edite e acompanhe seu hist√≥rico de glicemia e refei√ß√µes.</p>
                    <a href="{{ url_for('registros') }}" class="btn btn-outline-light mt-auto">
                        <i class="fas fa-eye me-2"></i>Ver Registros
                    </a>
                </div>
            </div>
        </div>
    </div>

    ---

    <h2 class="text-center mt-5 mb-4 text-secondary">Calculadoras</h2>
    <div class="row row-cols-1 row-cols-md-2 g-4 justify-content-center">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-info text-dark">
                <div class="card-body d-flex flex-column align-items-center text-center">
                    <i class="fas fa-calculator fa-3x mb-3"></i>
                    <h5 class="card-title">Calcular Bolus</h5>
                    <p class="card-text">Calcule a dose de insulina para sua refei√ß√£o e corre√ß√£o de glicemia.</p>
                    <a href="{{ url_for('calcular_bolus') }}" class="btn btn-outline-dark mt-auto">
                        <i class="fas fa-calculator me-2"></i>Calcular
                    </a>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-dark text-white">
                <div class="card-body d-flex flex-column align-items-center text-center">
                    <i class="fas fa-hand-holding-medical fa-3x mb-3"></i>
                    <h5 class="card-title">Calcular Fator de Sensibilidade</h5>
                    <p class="card-text">Descubra seu Fator de Sensibilidade √† Insulina com base no seu DTDI.</p>
                    <a href="{{ url_for('calcular_fs') }}" class="btn btn-outline-light mt-auto">
                        <i class="fas fa-hand-point-right me-2"></i>Calcular
                    </a>
                </div>
            </div>
        </div>
    </div>

    ---

    <h2 class="text-center mt-5 mb-4 text-secondary">Recursos e Informa√ß√µes</h2>
    <div class="row row-cols-1 row-cols-md-2 g-4 justify-content-center">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-secondary text-white">
                <div class="card-body d-flex flex-column align-items-center text-center">
                    <i class="fas fa-book-medical fa-3x mb-3"></i>
                    <h5 class="card-title">Guia Completo sobre Insulina</h5>
                    <p class="card-text">Leia nosso guia detalhado e aprenda mais sobre o uso e tipos de insulina.</p>
                    <a href="{{ url_for('guia_insulina') }}" class="btn btn-outline-light mt-auto">
                        <i class="fas fa-book me-2"></i>Abrir Guia
                    </a>
                </div>
            </div>
        </div>
    </div>

    {% if session.get('role') == 'admin' %}
    <h2 class="text-center mt-5 mb-4 text-secondary">Painel do Administrador</h2>
    <div class="row row-cols-1 row-cols-md-2 g-4 justify-content-center">
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-warning text-dark">
                <div class="card-body d-flex flex-column align-items-center text-center">
                    <i class="fas fa-users-cog fa-3x mb-3"></i>
                    <h5 class="card-title">Gerenciar Usu√°rios</h5>
                    <p class="card-text">Adicione, edite ou remova usu√°rios do sistema.</p>
                    <a href="{{ url_for('gerenciar_usuarios') }}" class="btn btn-outline-dark mt-auto">
                        <i class="fas fa-user-plus me-2"></i>Gerenciar
                    </a>
                </div>
            </div>
        </div>
        <div class="col">
            <div class="card h-100 shadow-sm border-0 bg-danger text-white">
                <div class="card-body d-flex flex-column align-items-center text-center">
                    <i class="fas fa-apple-alt fa-3x mb-3"></i>
                    <h5 class="card-title">Registrar Alimento</h5>
                    <p class="card-text">Adicione novos alimentos √† base de dados para uso nas refei√ß√µes.</p>
                    <a href="{{ url_for('registrar_alimento') }}" class="btn btn-outline-light mt-auto">
                        <i class="fas fa-plus me-2"></i>Registrar
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}